{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "31923a2b-1466-4449-a992-43267d20f512",
   "metadata": {},
   "source": [
    "Exam 2\n",
    "Author: Dylan Andrews"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "42dd1ee9-3c57-49f5-b408-501d420f73ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import plotly.express as px\n",
    "from plotly.subplots import make_subplots\n",
    "import plotly.io as pio\n",
    "pio.renderers.defaule = 'colab'\n",
    "\n",
    "from itables import show\n",
    "\n",
    "# This stops a few warning messages from showing\n",
    "pd.options.mode.chained_assignment = None \n",
    "import warnings\n",
    "warnings.simplefilter(action='ignore', category=FutureWarning)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ca22ad63-fa70-431f-88bd-b95006066656",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_name = 'flights'\n",
    "file_location = 'https://joannabieri.com/introdatascience/data/'+file_name+'.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7c319779-5e62-45fe-b1cd-5170470443c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_name = 'weather'\n",
    "file_location = 'https://joannabieri.com/introdatascience/data/'+file_name+'.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f2a72fa1-27ca-4fdc-960c-4dc6a181b8b5",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_name = 'planes'\n",
    "file_location = 'https://joannabieri.com/introdatascience/data/'+file_name+'.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "0cdfa15a-504d-4def-9f40-0432a6ccab90",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_name = 'airports'\n",
    "file_location = 'https://joannabieri.com/introdatascience/data/'+file_name+'.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "379624d8-6f33-4172-81b0-21c0ed535d14",
   "metadata": {},
   "outputs": [],
   "source": [
    "file_name = 'airlines'\n",
    "file_location = 'https://joannabieri.com/introdatascience/data/'+file_name+'.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "6e1d0a6a-0f80-49cc-9dda-29a79e005c58",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>dep_time</th>\n",
       "      <th>sched_dep_time</th>\n",
       "      <th>dep_delay</th>\n",
       "      <th>arr_time</th>\n",
       "      <th>sched_arr_time</th>\n",
       "      <th>arr_delay</th>\n",
       "      <th>carrier</th>\n",
       "      <th>flight</th>\n",
       "      <th>tailnum</th>\n",
       "      <th>origin</th>\n",
       "      <th>dest</th>\n",
       "      <th>air_time</th>\n",
       "      <th>distance</th>\n",
       "      <th>hour</th>\n",
       "      <th>minute</th>\n",
       "      <th>time_hour</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>517.0</td>\n",
       "      <td>515</td>\n",
       "      <td>2.0</td>\n",
       "      <td>830.0</td>\n",
       "      <td>819</td>\n",
       "      <td>11.0</td>\n",
       "      <td>UA</td>\n",
       "      <td>1545</td>\n",
       "      <td>N14228</td>\n",
       "      <td>EWR</td>\n",
       "      <td>IAH</td>\n",
       "      <td>227.0</td>\n",
       "      <td>1400.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2013-01-01 10:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>533.0</td>\n",
       "      <td>529</td>\n",
       "      <td>4.0</td>\n",
       "      <td>850.0</td>\n",
       "      <td>830</td>\n",
       "      <td>20.0</td>\n",
       "      <td>UA</td>\n",
       "      <td>1714</td>\n",
       "      <td>N24211</td>\n",
       "      <td>LGA</td>\n",
       "      <td>IAH</td>\n",
       "      <td>227.0</td>\n",
       "      <td>1416.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>2013-01-01 10:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>542.0</td>\n",
       "      <td>540</td>\n",
       "      <td>2.0</td>\n",
       "      <td>923.0</td>\n",
       "      <td>850</td>\n",
       "      <td>33.0</td>\n",
       "      <td>AA</td>\n",
       "      <td>1141</td>\n",
       "      <td>N619AA</td>\n",
       "      <td>JFK</td>\n",
       "      <td>MIA</td>\n",
       "      <td>160.0</td>\n",
       "      <td>1089.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>2013-01-01 10:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>544.0</td>\n",
       "      <td>545</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>1004.0</td>\n",
       "      <td>1022</td>\n",
       "      <td>-18.0</td>\n",
       "      <td>B6</td>\n",
       "      <td>725</td>\n",
       "      <td>N804JB</td>\n",
       "      <td>JFK</td>\n",
       "      <td>BQN</td>\n",
       "      <td>183.0</td>\n",
       "      <td>1576.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>2013-01-01 10:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2013</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>554.0</td>\n",
       "      <td>600</td>\n",
       "      <td>-6.0</td>\n",
       "      <td>812.0</td>\n",
       "      <td>837</td>\n",
       "      <td>-25.0</td>\n",
       "      <td>DL</td>\n",
       "      <td>461</td>\n",
       "      <td>N668DN</td>\n",
       "      <td>LGA</td>\n",
       "      <td>ATL</td>\n",
       "      <td>116.0</td>\n",
       "      <td>762.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-01-01 11:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>336771</th>\n",
       "      <td>2013</td>\n",
       "      <td>9</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1455</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1634</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9E</td>\n",
       "      <td>3393</td>\n",
       "      <td>NaN</td>\n",
       "      <td>JFK</td>\n",
       "      <td>DCA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>213.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>2013-09-30 18:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>336772</th>\n",
       "      <td>2013</td>\n",
       "      <td>9</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2200</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2312</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9E</td>\n",
       "      <td>3525</td>\n",
       "      <td>NaN</td>\n",
       "      <td>LGA</td>\n",
       "      <td>SYR</td>\n",
       "      <td>NaN</td>\n",
       "      <td>198.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2013-10-01 02:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>336773</th>\n",
       "      <td>2013</td>\n",
       "      <td>9</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1210</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1330</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MQ</td>\n",
       "      <td>3461</td>\n",
       "      <td>N535MQ</td>\n",
       "      <td>LGA</td>\n",
       "      <td>BNA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>764.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2013-09-30 16:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>336774</th>\n",
       "      <td>2013</td>\n",
       "      <td>9</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1159</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1344</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MQ</td>\n",
       "      <td>3572</td>\n",
       "      <td>N511MQ</td>\n",
       "      <td>LGA</td>\n",
       "      <td>CLE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>419.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>2013-09-30 15:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>336775</th>\n",
       "      <td>2013</td>\n",
       "      <td>9</td>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>840</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1020</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MQ</td>\n",
       "      <td>3531</td>\n",
       "      <td>N839MQ</td>\n",
       "      <td>LGA</td>\n",
       "      <td>RDU</td>\n",
       "      <td>NaN</td>\n",
       "      <td>431.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>2013-09-30 12:00:00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>336776 rows × 19 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        year  month  day  dep_time  sched_dep_time  dep_delay  arr_time  \\\n",
       "0       2013      1    1     517.0             515        2.0     830.0   \n",
       "1       2013      1    1     533.0             529        4.0     850.0   \n",
       "2       2013      1    1     542.0             540        2.0     923.0   \n",
       "3       2013      1    1     544.0             545       -1.0    1004.0   \n",
       "4       2013      1    1     554.0             600       -6.0     812.0   \n",
       "...      ...    ...  ...       ...             ...        ...       ...   \n",
       "336771  2013      9   30       NaN            1455        NaN       NaN   \n",
       "336772  2013      9   30       NaN            2200        NaN       NaN   \n",
       "336773  2013      9   30       NaN            1210        NaN       NaN   \n",
       "336774  2013      9   30       NaN            1159        NaN       NaN   \n",
       "336775  2013      9   30       NaN             840        NaN       NaN   \n",
       "\n",
       "        sched_arr_time  arr_delay carrier  flight tailnum origin dest  \\\n",
       "0                  819       11.0      UA    1545  N14228    EWR  IAH   \n",
       "1                  830       20.0      UA    1714  N24211    LGA  IAH   \n",
       "2                  850       33.0      AA    1141  N619AA    JFK  MIA   \n",
       "3                 1022      -18.0      B6     725  N804JB    JFK  BQN   \n",
       "4                  837      -25.0      DL     461  N668DN    LGA  ATL   \n",
       "...                ...        ...     ...     ...     ...    ...  ...   \n",
       "336771            1634        NaN      9E    3393     NaN    JFK  DCA   \n",
       "336772            2312        NaN      9E    3525     NaN    LGA  SYR   \n",
       "336773            1330        NaN      MQ    3461  N535MQ    LGA  BNA   \n",
       "336774            1344        NaN      MQ    3572  N511MQ    LGA  CLE   \n",
       "336775            1020        NaN      MQ    3531  N839MQ    LGA  RDU   \n",
       "\n",
       "        air_time  distance  hour  minute            time_hour  \n",
       "0          227.0    1400.0   5.0    15.0  2013-01-01 10:00:00  \n",
       "1          227.0    1416.0   5.0    29.0  2013-01-01 10:00:00  \n",
       "2          160.0    1089.0   5.0    40.0  2013-01-01 10:00:00  \n",
       "3          183.0    1576.0   5.0    45.0  2013-01-01 10:00:00  \n",
       "4          116.0     762.0   6.0     0.0  2013-01-01 11:00:00  \n",
       "...          ...       ...   ...     ...                  ...  \n",
       "336771       NaN     213.0  14.0    55.0  2013-09-30 18:00:00  \n",
       "336772       NaN     198.0  22.0     0.0  2013-10-01 02:00:00  \n",
       "336773       NaN     764.0  12.0    10.0  2013-09-30 16:00:00  \n",
       "336774       NaN     419.0  11.0    59.0  2013-09-30 15:00:00  \n",
       "336775       NaN     431.0   8.0    40.0  2013-09-30 12:00:00  \n",
       "\n",
       "[336776 rows x 19 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Load the data.\n",
    "file_name = 'flights'\n",
    "file_location = 'https://joannabieri.com/introdatascience/data/'+file_name+'.csv'\n",
    "DF = pd.read_csv(file_location)\n",
    "DF"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fa261b65-e90c-4c02-b616-fa57889159d7",
   "metadata": {},
   "source": [
    "P. Preliminaries(5 points)\n",
    "Do an initial exploration of the flights data. Report on all the typical things: Variables, Observations, Data Types, Weirdness or NaNs…"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f76a6637-dbba-4b75-be50-0e0651def307",
   "metadata": {},
   "source": [
    "Answer: There are 19 variables, and 336,776 Observations.\n",
    "\"year\" - Numerical integer\n",
    "\"month\" - Numerical integer\n",
    "\"day\" - Numerical integer\n",
    "\"dep_time\" - Numerical, has some NaN, (float)\n",
    "\"sched_dep_time\" - Numerical\n",
    "\"dep_delay\" -  Numerical, has some NaN, (float)\n",
    "\"arr_time\" -Numerical, has some NaN, (float)\n",
    "\"sched_arr_time\" - Numerical\n",
    "\"arr_day' - Numerical, has some NaN\n",
    "\"carrier\" - Categorical\n",
    "\"flight\" - Categorical\n",
    "\"tailum\" - Categorical\n",
    "\"origin\" -  Categorical\n",
    "\"dest\" - Categorical\n",
    "\"air_time\" - Numerical, has some NaN, (float)\n",
    "\"distance\" - Numerical, (float)\n",
    "\"hour\" - Numerical (float)\n",
    "\"minute\" - Numerical (float) \n",
    "\"time_hour\" - Numerical"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "8c6c4ede-ffb2-4ac8-ac26-6cde7c9c48a0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of observations (rows): 336776\n",
      "Number of variables (columns): 19\n"
     ]
    }
   ],
   "source": [
    "num_observations = DF.shape[0]\n",
    "print(\"Number of observations (rows):\", num_observations)\n",
    "\n",
    "num_variables = DF.shape[1]\n",
    "print(\"Number of variables (columns):\", num_variables)\n",
    "# I just used this code to find the number of observations and variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "7ec70213-c4f4-4a43-8a8f-19e2f2b1cd40",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['year', 'month', 'day', 'dep_time', 'sched_dep_time', 'dep_delay',\n",
       "       'arr_time', 'sched_arr_time', 'arr_delay', 'carrier', 'flight',\n",
       "       'tailnum', 'origin', 'dest', 'air_time', 'distance', 'hour', 'minute',\n",
       "       'time_hour'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "DF.columns"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae679df4-62d7-43bc-a544-c54401f21ebc",
   "metadata": {},
   "source": [
    "Question 1 (5 points)\n",
    "What are the ten most common destinations for flights from NYC airports in 2013?\n",
    "\n",
    "Make a table (Data Frame) that lists these in descending order of frequency and shows the number of flights heading to each airport.\n",
    "\n",
    "Hint: You can use the airports dataset to look up the airport name based on dest code. \n",
    "This is the ‘faa’ code. BEWARE: If you load in a new data frame give it a new name! \n",
    "Our main data is in DF."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "14d6525c-b336-4f69-a90b-3caf4b4a356e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "9b58903e-2c87-45ab-a357-1a3de080f788",
   "metadata": {},
   "source": [
    "Question 2 (5 points)\n",
    "Which airlines have the most flights departing from NYC airports in 2013?\n",
    "\n",
    "Make a table(Data Frame) that lists these in descending order of frequency and shows the number of flights for each airline. In your narrative mention the names of the airlines as well.\n",
    "\n",
    "Hint: You can use the airlines dataset to look up the airline name based on carrier code. BEWARE: If you load in a new data frame give it a new name! Our main data is in DF.\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f6eeba74-8f30-472e-b18f-33fae417e772",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "441c31f8-d210-4ba2-ac81-b0132243dfc1",
   "metadata": {},
   "source": [
    "Question 3 (10 points)\n",
    "Consider only flights that have non-missing arrival delay information and answer the questions below. Your answer should include the name of the carrier in addition to the carrier code and the values asked.\n",
    "\n",
    "Hint: The easiest way to do this is replace the NaNs in just the ‘arr_delay’ column with some other string, like ‘NA’ and then create a mask, but you could also use some of the more fancy na tools.\n",
    "\n",
    "a. Which carrier had the highest mean arrival delay?\n",
    "\n",
    "b. Which carrier had the lowest mean arrival delay?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3702af6c-d3e7-46da-addf-e4889f72905d",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "9313f854-1be2-453e-926a-01317dc08d5f",
   "metadata": {},
   "source": [
    "Question 4 (15 points)\n",
    "Consider breaking the day into four time intervals: 12:00am-6am, 6:01am-12pm, 12:01pm-6pm, 6:01pm-11:59pm, then answer the questions below.\n",
    "\n",
    "Hint: the data puts uses the format HHMM or HMM for hours and minutes and uses a 24-hour clock. So 12:01am = 1, 6am = 600,…., 6:01pm = 1801, 12am = 0. We did something similar to this in our homework when we were gathering age groups for our Lego purchasers.\n",
    "\n",
    "a. Calculate the proportion of flights that are delayed at departure at each of these time intervals.\n",
    "\n",
    "b. Comment on how the likelihood of being delayed change throughout the day? What is the probability of being delayed given each time period?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "11dc33dc-0f84-41f1-a720-e5a93304fb51",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "89d87571-b09f-4b5d-a014-1e0954288d2a",
   "metadata": {},
   "source": [
    "Question 5 (15 points)\n",
    "Find the flight with the longest air time.\n",
    "\n",
    "a. How long is this flight?\n",
    "\n",
    "b. What city did it fly to?\n",
    "\n",
    "c. How many seats does the plane that flew this flight have?\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b73456c2-cfeb-4dda-8610-1a43f6421d08",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "1ce6c33a-00d2-4e7e-b016-a8232fa90b28",
   "metadata": {},
   "source": [
    "Question 6 (15 pts)\n",
    "The airports data frame contains information on a large number of primarily American airports. These data include location information for these airports in the form of latitude and longitude coordinates. In this question we limit our focus to the Contiguous United States. Visualize and describe the distribution of the longitudes of airports in the Contiguous United States. What does this tell you about the geographical distribution of these airports?\n",
    "\n",
    "Hint: I used a histogram, but I could imagine some other really nice ways to do this.\n",
    "\n",
    "Hint: You will first need to limit your analysis to the Contiguous United States. This Wikipedia article can help, but you’re welcomed to use other resources as well. Make sure to cite whatever resource you use."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b2c04090-aef0-4b87-8a6b-6f22aca43c98",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "b020a4a0-1cb6-4dd7-ae62-2afb50a0f27e",
   "metadata": {},
   "source": [
    "Question 7 (15 pts)\n",
    "Recreate the plot included below using the flights data. Do the best you can to get as close as possible to what you see here. Once you have created the visualization, in no more than one paragraph, describe what you think the point of this visualization might be.\n",
    "\n",
    "Hint: The visualization uses the variable arrival, which is not included in the flights data frame. You will have to create arrival yourself, it is a categorical variable that is equal to \"ontime\" when arr_delay <= 0 and \"delayed\" when arr_delay > 0. Hint: I used a lambda with an if else inside.\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d14da549-f973-4dd8-9359-23e4a7800490",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "c8c63bdd-b14e-4fbe-9829-425bf0203ed7",
   "metadata": {},
   "source": [
    "Question 8 (15 pts)\n",
    "Create your own data visualization that explores delayed flights. Here you are using any or all of the data sets to explore a question related to delayed flights. You are encouraged to come up with your own questions, but here are some ideas:\n",
    "\n",
    "Is there an association between weather and flight delays?\n",
    "Are large flights or small flights more likely to be late?\n",
    "Are there certain destinations each month that are most likely to be late?\n",
    "Can you find a pattern behind why some carriers are often delayed?\n",
    "Really show off here! I reserve the right to assign up to 5 points extra credit for really outstanding analysis, explanations, and multiple explorations here."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
